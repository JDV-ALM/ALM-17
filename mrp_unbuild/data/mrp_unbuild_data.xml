<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">
        <!-- ============================================ -->
        <!-- SECUENCIAS -->
        <!-- ============================================ -->
        
        <!-- Secuencia para órdenes de desposte -->
        <record id="seq_mrp_unbuild_production" model="ir.sequence">
            <field name="name">Unbuild Order</field>
            <field name="code">mrp.production.unbuild</field>
            <field name="prefix">UO/</field>
            <field name="padding">5</field>
            <field name="company_id" eval="False"/>
        </record>
        
        <!-- ============================================ -->
        <!-- RUTAS Y REGLAS -->
        <!-- ============================================ -->
        
        <!-- Ruta para desposte -->
        <record id="route_unbuild" model="stock.route">
            <field name="name">Unbuild</field>
            <field name="active" eval="False"/>
            <field name="product_selectable" eval="False"/>
            <field name="warehouse_selectable" eval="True"/>
            <field name="warehouse_ids" eval="[(6, 0, [])]"/>
            <field name="company_id" eval="False"/>
            <field name="sequence">20</field>
        </record>
        
        <!-- ============================================ -->
        <!-- CATEGORÍAS DE PRODUCTOS PARA DESPOSTE -->
        <!-- ============================================ -->
        
        <!-- Categoría para productos de desposte -->
        <record id="product_category_unbuild" model="product.category">
            <field name="name">Unbuild Products</field>
            <field name="parent_id" ref="product.product_category_all"/>
        </record>
        
        <!-- Categoría para subproductos -->
        <record id="product_category_unbuild_output" model="product.category">
            <field name="name">Unbuild Outputs</field>
            <field name="parent_id" ref="product_category_unbuild"/>
        </record>
        
        <!-- Categoría para desperdicios -->
        <record id="product_category_unbuild_waste" model="product.category">
            <field name="name">Unbuild Waste</field>
            <field name="parent_id" ref="product_category_unbuild"/>
        </record>
        
        <!-- ============================================ -->
        <!-- UBICACIONES DE INVENTARIO -->
        <!-- ============================================ -->
        
        <!-- Ubicación virtual para pérdidas de desposte -->
        <record id="location_unbuild_loss" model="stock.location">
            <field name="name">Unbuild Loss</field>
            <field name="usage">inventory</field>
            <field name="location_id" ref="stock.stock_location_locations_virtual"/>
            <field name="company_id" eval="False"/>
            <field name="active" eval="True"/>
            <field name="comment">Virtual location for unbuild process losses</field>
        </record>
        
        <!-- ============================================ -->
        <!-- PARÁMETROS DE CONFIGURACIÓN -->
        <!-- ============================================ -->
        
        <!-- Parámetro para control de rendimientos (obsoleto - usar grupo) -->
        <record id="config_parameter_unbuild_strict_yields" model="ir.config_parameter">
            <field name="key">mrp.unbuild.strict_yields</field>
            <field name="value">False</field>
        </record>
        
        <!-- Parámetro para permitir backorders en desposte -->
        <record id="config_parameter_unbuild_allow_backorder" model="ir.config_parameter">
            <field name="key">mrp.unbuild.allow_backorder</field>
            <field name="value">True</field>
        </record>
        
        <!-- Parámetro para tolerancia de rendimiento -->
        <record id="config_parameter_unbuild_yield_tolerance" model="ir.config_parameter">
            <field name="key">mrp.unbuild.yield_tolerance</field>
            <field name="value">5.0</field>
        </record>
        
        <!-- Parámetro para asignación estricta de costos -->
        <record id="config_parameter_unbuild_strict_cost_allocation" model="ir.config_parameter">
            <field name="key">mrp.unbuild.strict_cost_allocation</field>
            <field name="value">False</field>
        </record>
    </data>
    
    <!-- ============================================ -->
    <!-- FUNCIÓN DE CREACIÓN DE TIPOS DE PICKING -->
    <!-- ============================================ -->
    <data noupdate="0">
        <!-- Tipo de operación para desposte - se crea uno por cada warehouse -->
        <function model="stock.warehouse" name="search">
            <value eval="[('company_id', '=', obj().env.company.id)]"/>
            <function name="create_unbuild_picking_type" eval="True"/>
        </function>
    </data>
</odoo>